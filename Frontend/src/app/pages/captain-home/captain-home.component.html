<!-- Navbar -->
<app-navbar-captain></app-navbar-captain>

<!-- Main section -->
<section>
  <div class="container d-block">
    <div class="row">
      <div class="col-12">
        <div class="alert alert-warning alert-dismissible fade show mb-lg-2 mt-lg-2 mt-md-3 mt-2" role="alert">
          <strong class="fs-5">Hello {{ captainDetail.fullname?.firstname }}!</strong> 
          <span *ngIf="(captainDetail.status === 1 || captainDetail.status === 0) && captainDetail.documents">
            {{"Your document is not verified. Contact to admin team" | translate}}.
          </span>
          <span *ngIf="documentsAvailable === 'undefined' || documentsAvailable?.aadharfront === false || documentsAvailable?.aadharback === false || documentsAvailable?.drivinglicense === false || documentsAvailable?.rc === false">
            {{"Please upload your documents" | translate}} <a routerLink="/captain-upload-document" class="alert-link">{{'here' | translate}}..</a>
          </span>
          <span *ngIf="captainDetail.status == 2 && captainDetail.documents && wallet?.balance >= 500">
            {{"Your document is verified. You can go online for rides" | translate}}.
          </span>
          <span *ngIf="captainDetail.status == 3 && captainDetail.documents">
            {{"Your document is rejected. Contact to admin team" | translate}}.
          </span>
          <span *ngIf="captainDetail.status == 2 && captainDetail.documents && wallet?.balance < 500">
            {{"Your wallet balance is less than 500 please recharge a wallet" | translate}} <a routerLink="/wallet-captain" class="alert-link">{{'here' | translate}}..</a>
          </span>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      </div>
      <div class="col-lg-4 col-md-12 my-lg-4 mt-md-3">
        <div
          class="shadow p-3 mb-lg-4 mb-3 bg-body-tertiary rounded mt-md-0 mt-lg-0 mt-3"
        >
          <div>
            <p class="fs-4 fw-bolder mx-1">{{'Go online for get the ride' | translate}}</p>
            <p class="fs-6">
              {{"Once's you go online you can get a ride notification which generated by user...." | translate}}
            </p>
          </div>
          <button
            class="btn-on-off"
            [ngClass]="{ 'btn-online': isOnline, 'btn-offline': !isOnline }"
            [disabled]="captainDetail.status !== 2 || wallet?.balance < 500"
            (click)="toggleCaptainStatus()"
            role="button"
            tabindex="0"
          >
            {{ isOnline ? ("Online" | translate) : ("Offline" | translate) }}
          </button>
        </div>
                
        <div class="card p-3 mb-4 rounded d-md-none d-sm-none d-none d-lg-block">
          <h5 class="mb-3 fs-4 fw-bold">
            Your reviews added by users
          </h5>
          <p>
            Make sure to provide a clean vehicle, be on time, and maintain good captain behavior to receive positive reviews from user.
          </p>
        
          <div *ngIf="ratings.totalReviews !== 0">
            <div class="d-flex align-items-center mb-3">
              <h2 class="mb-0 me-2">{{ ratings.overall }}</h2>
              <div>
                <span *ngFor="let star of getStars(ratings.overall)" class="text-warning fs-4">{{ star }}</span>
              </div>
              <small class="text-muted ms-2">({{ ratings.totalReviews }} reviews)</small>
            </div>
          
            <div class="mb-2">
              <strong>ðŸ§¼ Clean Vehicle:</strong>
              <span class="mx-2">{{ ratings.vehicle }}/5</span>
              <span *ngFor="let star of getStars(ratings.vehicle)" class="text-warning">{{ star }}</span>
            </div>
          
            <div class="mb-2">
              <strong>ðŸ•’ On Time:</strong>
              <span class="mx-2">{{ ratings.onTime }}/5</span>
              <span *ngFor="let star of getStars(ratings.onTime)" class="text-warning">{{ star }}</span>
            </div>
          
            <div class="mb-2">
              <strong>ðŸ™‚ Driver Behaviour:</strong>
              <span class="mx-2">{{ ratings.behaviour }}/5</span>
              <span *ngFor="let star of getStars(ratings.behaviour)" class="text-warning">{{ star }}</span>
            </div>
          </div>

          <div *ngIf="ratings.totalReviews === 0 || ratings === 'undefined'">
            <p class="text-danger fw-semibold">
              No reviews available..
            </p>
          </div>
        
          <!-- <hr />
        
          <div *ngIf="ratings.comments?.length">
            <h6>Recent Reviews</h6>
            <div class="overflow-auto" style="max-height: 200px;">
              <div *ngFor="let comment of ratings.comments" class="border-bottom py-2">
                <strong>{{ comment.user }}:</strong> {{ comment.text }}
              </div>
            </div>
          </div> -->

        </div>        

      </div>
      <div class="col-lg-8 col-md-12 my-lg-4">
        <div class="card my-4 my-lg-1 rounded-4">
          <img
            src="../../../assets/images/rider_captain_home.avif"
            class="card-img-top card-img"
            alt="trips_image"
          />
          <div class="card-body">
            <div class="row">
              <div class="col-md-8">
                <p class="card-title fs-3 fw-bold">
                  {{ captainDetail.fullname?.firstname }}
                  {{ captainDetail.fullname?.lastname }}
                </p>
                <p class="card-title fs-5 fw-semibold">
                  {{'Total earnings' | translate}}: {{ captainDetail.totalEarning }}
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Document verification' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    captainDetail.status == 2 ? ("Verified" | translate) : ("Not Verified" | translate)
                  }}</small>
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Email verification' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    captainDetail.isEmailVerified == true
                      ? ("Verified" | translate)
                      : ("Not Verified" | translate)
                  }}</small>
                </p>
                <p class="card-text">
                  <small class="text-body-secondary fw-bold">{{'Created on' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    captainDetail.createOn | date
                  }}</small>
                </p>
              </div>
              <div class="col-md-4">
                <div class="d-flex float-end mt-1 mt-md-0 mt-lg-0">
                  <button class="trips-btn me-2 my-2">
                    <i class="bi bi-question-circle me-2"></i>{{'Help' |translate}}
                  </button>
                  <button class="trips-btn me-2 my-2" routerLink="/captain-profile">
                    <i class="bi bi-info-circle me-2"></i>{{'Details' | translate}}
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- <div class="card-body">
              <p class="fs-3 fw-bold">You have no ongoing trips</p>
            </div> -->
        </div>

        <div class="row">
          <div class="col-lg-6 mt-lg-2">
            <div class="card mb-4">
              <div class="card-body">
                <p class="card-title fs-4 fw-semibold">{{'Vehicle details' | translate}}</p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{"Vehicle type" | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    captainDetail.vehicle?.vehicleType
                  }}</small>
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Vehicle number' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    captainDetail.vehicle?.plate
                  }}</small>
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Vehicle capacity' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    captainDetail.vehicle?.capacity
                  }}</small>
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Vehicle color' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    captainDetail.vehicle?.color
                  }}</small>
                </p>
              </div>
            </div>
          </div>

          <div class="col-lg-6 mt-lg-2">
            <div class="card mb-4">
              <div class="card-body">
                <p class="card-title fs-4 fw-semibold">
                  {{'Uploaded document details' | translate}}
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Aadhar card front side' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">
                    {{
                      documentsAvailable?.aadharfront
                        ? ("Uploaded" | translate)
                        : ("Not Uploaded" | translate)
                    }}
                  </small>
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Aadhar card back side' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    documentsAvailable?.aadharback ? ("Uploaded" | translate)
                    : ("Not Uploaded" | translate)
                  }}</small>
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Driving license' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">{{
                    documentsAvailable?.drivinglicense
                    ? ("Uploaded" | translate)
                    : ("Not Uploaded" | translate)
                  }}</small>
                </p>
                <p class="card-text mb-0">
                  <small class="text-body-secondary fw-bold"
                    >{{'Register certificate' | translate}}</small
                  ><i class="bi bi-dot"></i
                  ><small class="text-body-secondary">
                    {{
                      documentsAvailable?.rc ? ("Uploaded" | translate)
                      : ("Not Uploaded" | translate)
                    }}</small
                  >
                </p>
              </div>
            </div>
          </div>

          <div class="col-lg-6 mt-lg-2">
            <div class="card p-3 mb-4 rounded d-block d-lg-none">
              <h5 class="mb-3 fs-4 fw-bold">
                Your reviews added by users
              </h5>
              <p>
                Make sure to provide a clean vehicle, be on time, and maintain good captain behavior to receive positive reviews from user.
              </p>
            
              <div *ngIf="ratings.totalReviews !== 0">
                <div class="d-flex align-items-center mb-3">
                  <h2 class="mb-0 me-2">{{ ratings.overall }}</h2>
                  <div>
                    <span *ngFor="let star of getStars(ratings.overall)" class="text-warning fs-4">{{ star }}</span>
                  </div>
                  <small class="text-muted ms-2">({{ ratings.totalReviews }} reviews)</small>
                </div>
              
                <div class="mb-2">
                  <strong>ðŸ§¼ Clean Vehicle:</strong>
                  <span class="mx-2">{{ ratings.vehicle }}/5</span>
                  <span *ngFor="let star of getStars(ratings.vehicle)" class="text-warning">{{ star }}</span>
                </div>
              
                <div class="mb-2">
                  <strong>ðŸ•’ On Time:</strong>
                  <span class="mx-2">{{ ratings.onTime }}/5</span>
                  <span *ngFor="let star of getStars(ratings.onTime)" class="text-warning">{{ star }}</span>
                </div>
              
                <div class="mb-2">
                  <strong>ðŸ™‚ Driver Behaviour:</strong>
                  <span class="mx-2">{{ ratings.behaviour }}/5</span>
                  <span *ngFor="let star of getStars(ratings.behaviour)" class="text-warning">{{ star }}</span>
                </div>
              </div>
    
              <div *ngIf="ratings.totalReviews === 0 || ratings === 'undefined'">
                <p class="text-danger fw-semibold">
                  No reviews available..
                </p>
              </div>    
            </div>  
        </div>  

        </div>
      </div>
    </div>
  </div>
</section>

<app-ride-popup></app-ride-popup>
